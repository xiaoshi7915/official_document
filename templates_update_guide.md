# 模板文件更新指南

## 概述
为了确保公文生成系统能够正确替换模板中的字段，需要将现有的模板文件中的占位符更新为 `{{}}` 格式。

## 更新步骤

### 1. 报告模板 (baogao.docx)
需要替换的占位符：

**版头部分：**
- `××★1年` → `{{year}}`
- `特急` → `{{urgencyLevel}}`
- `机关代字(20××)×号` → `{{senderCode}}({{year}}){{serialNumber}}号`
- `签发人:姓名一姓名二` → `签发人:{{senderSignature}}`

**主体部分：**
- `××××关于××××XXXXXXXX×××的报告` → `{{title}}`
- `主送机关:` → `主送机关:{{recipient}}`
- `正文内容` → `{{content}}`

**署名部分：**
- `机关短署名` → `{{senderSignature}}`
- `20××年×月×日` → `{{date}}`
- `(附注内容)` → `({{notes}})`

**版记部分：**
- `抄送:抄送机关1,抄送机关2,抄送机关3,抄送机关4,抄送机关5。` → `抄送:{{copyTo}}`

**印发部分：**
- `印发机关` → `{{printingOrg}}`
- `20××年×月×日印发` → `{{printingDate}}印发`

### 2. 纪要模板 (jiyao.docx)
需要替换的占位符：

**版头部分：**
- `××★1年` → `{{year}}`
- `特急` → `{{urgencyLevel}}`
- `机关代字(20××)×号` → `{{senderCode}}({{year}}){{serialNumber}}号`
- `签发人:姓名一姓名二` → `签发人:{{senderSignature}}`

**主体部分：**
- `××××关于××××XXXXXXXX×××的纪要` → `{{title}}`
- `主送机关:` → `主送机关:{{recipient}}`
- `正文内容` → `{{content}}`

**署名部分：**
- `机关短署名` → `{{senderSignature}}`
- `20××年×月×日` → `{{date}}`
- `(附注内容)` → `({{notes}})`

**版记部分：**
- `抄送:抄送机关1,抄送机关2,抄送机关3,抄送机关4,抄送机关5。` → `抄送:{{copyTo}}`

**印发部分：**
- `印发机关` → `{{printingOrg}}`
- `20××年×月×日印发` → `{{printingDate}}印发`

## 操作步骤

1. **打开Word模板文件**
   - 使用Microsoft Word或其他兼容的文档编辑器
   - 打开 `frontend/templates/` 目录下的模板文件

2. **使用查找替换功能**
   - 按 `Ctrl+H` 打开查找替换对话框
   - 逐个替换上述占位符

3. **保存文件**
   - 保存为 `.docx` 格式
   - 确保文件保存在正确的位置

4. **测试验证**
   - 重新启动后端服务
   - 在前端测试生成公文功能
   - 检查生成的文档是否正确替换了字段

## 注意事项

1. **保持格式**：替换时注意保持原有的字体、大小、对齐等格式
2. **备份原文件**：建议在更新前备份原始模板文件
3. **测试验证**：每个模板更新后都要进行测试验证
4. **一致性**：确保所有模板使用相同的占位符格式

## 常见问题

**Q: 替换后格式乱了怎么办？**
A: 使用Word的"查找替换"功能时，选择"更多选项" → "格式" → "保持格式"

**Q: 某些占位符找不到怎么办？**
A: 检查模板文件中的具体文本内容，可能占位符格式略有不同

**Q: 替换后文档无法打开怎么办？**
A: 检查文件是否损坏，可以尝试重新创建模板文件 